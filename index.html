<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="custom-checkbox.css">
    <link rel="stylesheet" href="tui-custom.css">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300;1,400&family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- CDN -->
    <link rel="stylesheet" href="tui-assets/css/toastui-calendar.min.css" />
    <!-- tui -->
    <link rel="stylesheet" href="tui-assets/css/tui-date-picker.css">
    <link rel="stylesheet" href="tui-assets/css/tui-time-picker.css">
</head>
<body>
    <div class="calendar-container">

        <div class="left-side">
            <div class="calendar">
                <div class="month">
                    <div class="date">
                        <div class="month-year">
                            <h1 id="c-month">MonthName</h1>
                            <h2 id="c-year">Year</h2>
                        </div>
                        <p id="c-date">Fri May 29, 2022</p>
                    </div>
                    <div class="pagination">
                        <i class="fas fa-angle-left prev"></i>
                        <i class="fas fa-angle-right next"></i>
                    </div>
                </div>
                <div class="weekdays">
                    <div>Sun</div>
                    <div>Mon</div>
                    <div>Tue</div>
                    <div>Wed</div>
                    <div>Thu</div>
                    <div>Fri</div>
                    <div>Sat</div>
                </div>
                <div class="days">
                    <!-- displays dates here -->
                </div>
            </div>


            <div class="calendars">
                <h1 class="calendars-title">
                    <!-- <i class="fas fa-cog"></i> -->
                    Change calendar view
                </h1>
                <div class="display-options">
                    <label class="option-item">
                        <input type="radio" name="default-view" value="day" checked>
                        <span>Day</span>
                    </label>
                    <label class="option-item">
                        <input type="radio" name="default-view" value="week">
                        <span>Week</span>
                    </label>
                    <label class="option-item">
                        <input type="radio" name="default-view" value="month">
                        <span>Month</span>
                    </label>
                </div>
            </div>
            
            <div class="calendars">
                <h1 class="calendars-title">
                    Other options
                </h1>
                <div class="display-options">
                    <label class="option-item">
                        <input type="checkbox" id="show-task">
                        <span>Show task</span>
                    </label>
                    <label class="option-item">
                        <input type="checkbox" id="show-currenttime" checked>
                        <span>Show current time</span>
                    </label>
                </div>
            </div>

            <!-- Calendars list -->
            <div class="calendars">
                <h1 class="calendars-title">
                    <!-- <i class="fas fa-calendar-alt"></i> -->
                    Calendars
                </h1>
                <div class="calendars-list" id="calendars-list">
                    <div class="calendars-item">
                        <div class="checkbox-wrapper-18">
                            <div class="round">
                              <input type="checkbox" id="checkbox-18" />
                              <label for="checkbox-18"></label>
                            </div>
                        </div>
                        <label for="checkbox-18">Calendar item</label>
                    </div>
                </div>
            </div>
        </div>
    

        <div class="timetable" id="calendar">
        </div>
    </div>
    <!-- with CDN and browser environment namespace -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="tui-assets/js/tui-time-picker.js"></script>
    <script src="tui-assets/js/tui-date-picker.js"></script>
    <script src="tui-assets/js/toastui-calendar.ie11.min.js"></script>
    <script src="utils/global-functions.js"></script>
    <script>
        const Calendar = tui.Calendar;
        const container = document.getElementById('calendar');
        const currentTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const events = [
            {
                id: 'event1',
                calendarId: 'cal2',
                title: 'Weekly meeting',
                start: '2023-12-07T09:00:00',
                end: '2023-12-07T10:00:00',
            },
            {
                id: 'event2',
                calendarId: 'cal1',
                title: 'Lunch appointment',
                start: '2023-12-08T07:00:00',
                end: '2023-12-08T10:00:00',
            },
            {
                id: 'event3',
                calendarId: 'cal3',
                title: 'Vacation',
                start: '2023-12-10T09:00:00',
                end: '2023-12-10T12:00:00',
                attendees: ['Me'],
                // isAllday: true,
                // category: 'allday',
            },
            
            {
                id: 'event4',
                calendarId: 'cal1',
                title: 'timed event',
                body: 'TOAST UI Calendar',
                start: '2023-12-01T10:00:00',
                end: '2023-12-01T11:00:00',
                location: 'Meeting Room A',
                attendees: ['A', 'B', 'C'],
                category: 'time',
                state: 'Free',
                isReadOnly: true,
                color: '#fff',
                backgroundColor: '#ccc',
                customStyle: {
                    fontStyle: 'italic',
                    fontSize: '15px',
                },
            }, // EventObject
        ]; 
        const calendars = [
                {
                    id: 'cal1',
                    name: 'Personal',
                    color: '#ffffff',
                    backgroundColor: '#9e5fff',
                    dragBackgroundColor: '#9e5fff',
                    borderColor: '#9e5fff',
                },
                {
                    id: 'cal2',
                    name: 'Work',
                    color: '#ffffff',
                    backgroundColor: '#00a9ff',
                    dragBackgroundColor: '#00a9ff',
                    borderColor: '#00a9ff',
                },
                {
                    id: 'cal3',
                    name: 'Birthday',
                    color: '#ffffff',
                    backgroundColor: '#ff5f5f',
                    dragBackgroundColor: '#ff5f5f',
                    borderColor: '#ff5f5f',
                    allday: true
                },
        ];
        const options = {
            defaultView: 'day',
            isReadOnly: false,
            usageStatistics: false,
            timezone: {
                zones: [
                    {
                        timezoneName: currentTz,
                        displayLabel: 'Timezone',
                    },
                ],
            },
            calendars: calendars,
            useFormPopup: true,
            useDetailPopup: true
        };

        const calendar = new Calendar(container, options);
        calendar.createEvents(events)

        calendar.setOptions({
            week: {
                showNowIndicator: true,
                narrowWeekend: true,
                taskView: false,
                startDayOfWeek: new Date().getDay()
            }
        });

        calendar.setOptions({
            template: {
                time(event) {
                    const start = event.start.d.d
                    const end = event.end.d.d
                    return `<p class="event-template">
                        <b>${customTime(start)} - ${customTime(end)}</b> <br/>
                        <span>${event.title}</span>
                    </p>`;
                },
                
                goingDuration(event) {
                    return `<span>${event.goingDuration}</span>`;
                },
            },
        });

        
        // get calendars
        var calendarInnerHTML = calendars.map(calendar => {
            return `
            <div class="calendars-item">
                <div class="checkbox-wrapper-18">
                    <div class="round">
                        <input type="checkbox" id="${calendar.id}" checked value="${calendar.id}"/>
                        <label for="${calendar.id}" style="background-color: ${calendar.backgroundColor};border-color: ${calendar.backgroundColor}"></label>
                    </div>
                </div>
                <label for="${calendar.id}">${calendar.name}</label>
            </div>`;
        }).join('')

        document.querySelector('#calendars-list').innerHTML = calendarInnerHTML;

        // event to change default view

        [...document.getElementsByName('default-view')].forEach(input => {
            console.log(input.value)
            input.addEventListener('click', () => {
                const view = input.value;
                calendar.changeView(view)
            });
        })

        // Show task in calendar. event handler
        document.querySelector('#show-task').addEventListener('click', (e) => {
            const isChecked = e.target.checked;
            calendar.setOptions({
                week: {
                    showNowIndicator: true,
                    narrowWeekend: true,
                    taskView: isChecked,
                }
            })
        });
        
        // Show current time in calendar. event handler
        document.querySelector('#show-currenttime').addEventListener('click', (e) => {
            calendar.setOptions({
                week: {
                    showNowIndicator: e.target.checked,
                }
            })
        });

        // Calendar check event 800 1100 1400
        document.querySelectorAll('#calendars-list input[type="checkbox"]').forEach(input => {
            input.addEventListener('change', () => {
                const isChecked = input.checked;
                calendar.setCalendarVisibility(input.value, isChecked);
            });
        });

        calendar.setOptions({
            template: {
                // time now display
                timegridNowIndicatorLabel({ time }) {
                    return customTime(time);
                },
                // vertical time dispaly
                timegridDisplayPrimaryTime({ time }) {
                    // french time
                    return customTime(time);
                },
                
                milestoneTitle() {
                    return `<span>Milestone events</span>`;
                },
                taskTitle() {
                    return `<span>Task events</span>`;
                },
                alldayTitle() {
                    return `<span>Allday events</span>`;
                },
                // POPUP
                popupIsAllday() {
                    return 'All day';
                },
                popupStateFree() {
                    return 'Free';
                },
                popupStateBusy() {
                    return 'Busy';
                },
                titlePlaceholder() {
                    return 'Title';
                },
                locationPlaceholder() {
                    return 'Location';
                },
                startDatePlaceholder() {
                    return 'Start date';
                },
                endDatePlaceholder() {
                    return 'End date';
                },
                popupSave() {
                    return 'Add';
                },
                popupUpdate() {
                    return 'Update';
                },
                popupEdit() {
                    return 'Edit';
                },
                popupDelete() {
                    return 'Delete';
                },
            },
            week: {
                dayNames: ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam']
            }
        });


    </script>
    <script src="script.js"></script>
    <script src="calendar-event.js"></script>
</body>
</html>