<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="custom-checkbox.css">
    <link rel="stylesheet" href="tui-assets/css/tui-custom.css">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300;1,400&family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- CDN -->
    <link rel="stylesheet" href="tui-assets/css/toastui-calendar.min.css" />
    <!-- tui -->
    <link rel="stylesheet" href="tui-assets/css/tui-date-picker.css">
    <link rel="stylesheet" href="tui-assets/css/tui-time-picker.css">
</head>
<body>
    <div class="calendar-container">

        <div class="left-side">
            <div class="calendar">
                <div class="month">
                    <div class="time-n-date">
                        <p id="c-time">00:00:00</p>
                        <span id="c-date">Fri May 29, 2022</span>
                    </div>
                    <div class="current-date">
                        <div class="month-year">
                            <h1 id="c-month">MonthName</h1>
                            <h1 id="c-year">Year</h1>
                        </div>
                        <div class="pagination">
                            <i class="fas fa-angle-left prev"></i>
                            <i class="fas fa-angle-right next"></i>
                        </div>
                    </div>
                </div>
                <div class="weekdays">
                    <div>Sun</div>
                    <div>Mon</div>
                    <div>Tue</div>
                    <div>Wed</div>
                    <div>Thu</div>
                    <div>Fri</div>
                    <div>Sat</div>
                </div>
                <div class="days">
                    <!-- displays dates here -->
                </div>
            </div>

            <fieldset class="calendars">
                <legend class="calendars-title" data-key="change_calendar_view">Change calendar view</legend>
                <div class="display-options">
                    <label class="option-item">
                        <input type="radio" name="default-view" value="day" checked>
                        <span data-key="day">Day</span>
                    </label>
                    <label class="option-item">
                        <input type="radio" name="default-view" value="week">
                        <span data-key="week">Week</span>
                    </label>
                    <label class="option-item">
                        <input type="radio" name="default-view" value="month">
                        <span data-key="month">Month</span>
                    </label>
                </div>
            </fieldset>
            
            <fieldset class="calendars">
                <legend class="calendars-title" data-key="other_options">Other options</legend>
                <div class="display-options">
                    <label class="option-item">
                        <input type="checkbox" id="show-task">
                        <span data-key="show_task">Show task</span>
                    </label>
                    <label class="option-item">
                        <input type="checkbox" id="show-currenttime" checked>
                        <span data-key="show_current_time">Show current time</span>
                    </label>
                </div>
            </fieldset>

            <!-- Calendars list -->
            <fieldset class="calendars">
                <legend class="calendars-title" data-key="mycalendars">Calendars</legend>
                <div class="calendars-list" id="calendars-list">
                    <div class="calendars-item">
                        <div class="checkbox-wrapper-18">
                            <div class="round">
                                <input type="checkbox" id="checkbox-18" />
                                <label for="checkbox-18"></label>
                            </div>
                        </div>
                        <label for="checkbox-18">Calendar item</label>
                    </div>
                </div>
            </fieldset>
        </div>
    

        <div class="timetable" id="calendar">
        </div>
    </div>
    <!-- with CDN and browser environment namespace -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="tui-assets/js/tui-time-picker.js"></script>
    <script src="tui-assets/js/tui-date-picker.js"></script>
    <script src="tui-assets/js/toastui-calendar.ie11.min.js"></script>
    <script src="utils/global-functions.js"></script>
    <script>
        const Calendar = tui.Calendar;
        const container = document.getElementById('calendar');
        const currentTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const events = [
            {
                id: 'event1',
                calendarId: 'cal2',
                title: 'Weekly meeting',
                start: '2023-12-07T09:00:00',
                end: '2023-12-07T10:00:00',
            },
            {
                id: 'event2',
                calendarId: 'cal1',
                title: 'Lunch appointment',
                start: '2023-12-08T07:00:00',
                end: '2023-12-08T10:00:00',
            },
            {
                id: 'event3',
                calendarId: 'cal3',
                title: 'Vacation',
                start: '2023-12-10T09:00:00',
                end: '2023-12-10T12:00:00',
                attendees: ['Me'],
                // isAllday: true,
                // category: 'allday',
            },
            
            {
                id: 'event4',
                calendarId: 'cal1',
                title: 'timed event',
                body: 'TOAST UI Calendar',
                start: '2023-12-01T10:00:00',
                end: '2023-12-01T11:00:00',
                location: 'Meeting Room A',
                attendees: ['A', 'B', 'C'],
                category: 'time',
                state: 'Free',
                isReadOnly: true,
                color: '#fff',
                backgroundColor: '#ccc',
                customStyle: {
                    fontStyle: 'italic',
                    fontSize: '15px',
                },
            }, // EventObject
        ]; 
        const calendars = [
                {
                    id: 'cal1',
                    name: 'Personal',
                    color: '#ffffff',
                    backgroundColor: '#9e5fff',
                    dragBackgroundColor: '#9e5fff',
                    borderColor: '#9e5fff',
                },
                {
                    id: 'cal2',
                    name: 'Work',
                    color: '#ffffff',
                    backgroundColor: '#00a9ff',
                    dragBackgroundColor: '#00a9ff',
                    borderColor: '#00a9ff',
                },
                {
                    id: 'cal3',
                    name: 'Birthday',
                    color: '#ffffff',
                    backgroundColor: '#ff5f5f',
                    dragBackgroundColor: '#ff5f5f',
                    borderColor: '#ff5f5f',
                    allday: true
                },
        ];
        const options = {
            defaultView: 'day',
            isReadOnly: false,
            usageStatistics: false,
            timezone: {
                zones: [
                    {
                        timezoneName: currentTz,
                        displayLabel: 'Timezone',
                    },
                ],
            },
            calendars: calendars,
            useFormPopup: true,
            useDetailPopup: true
        };

        const calendar = new Calendar(container, options);
        calendar.createEvents(events)

        calendar.setOptions({
            week: {
                startDayOfWeek: new Date().getDay()
            }
        });
        
        // get calendars
        var calendarInnerHTML = calendars.map(calendar => {
            return `
            <div class="calendars-item">
                <div class="checkbox-wrapper-18">
                    <div class="round">
                        <input type="checkbox" id="${calendar.id}" checked value="${calendar.id}"/>
                        <label for="${calendar.id}" style="background-color: ${calendar.backgroundColor};border-color: ${calendar.backgroundColor}"></label>
                    </div>
                </div>
                <label for="${calendar.id}">${calendar.name}</label>
            </div>`;
        }).join('')

        document.querySelector('#calendars-list').innerHTML = calendarInnerHTML;

        // update calendar by stored options
        calendar.changeView(CalendarView.get());
        calendar.setOptions({
            week: {
                taskView: TasksView.get(),
                showNowIndicator: CurrentTimeVisibility.get()
            }
        });
        document.querySelector('#show-task').checked = TasksView.get();
        document.querySelector('#show-currenttime').checked = CurrentTimeVisibility.get();

        // event to change default view
        [...document.getElementsByName('default-view')].forEach(input => {
            // activate calendar view accordings to the stored option
            input.checked = CalendarView.get() === input.value;
            
            input.addEventListener('click', () => {
                const view = input.value;
                calendar.changeView(view)
                CalendarView.set(view);
            });
        })

        // Show task in calendar. event handler
        document.querySelector('#show-task').addEventListener('click', (e) => {
            const isChecked = e.target.checked;
            calendar.setOptions({
                week: {
                    // narrowWeekend: true,
                    taskView: isChecked,
                }
            });

            TasksView.set(isChecked);
            // calendar.render();
        });
        
        // Show current time in calendar. event handler
        document.querySelector('#show-currenttime').addEventListener('click', (e) => {
            calendar.setOptions({
                week: {
                    showNowIndicator: e.target.checked,
                }
            });
            CurrentTimeVisibility.set(e.target.checked);
        });

        // Calendar check event 800 1100 1400
        document.querySelectorAll('#calendars-list input[type="checkbox"]').forEach(input => {
            input.addEventListener('change', () => {
                const isChecked = input.checked;
                calendar.setCalendarVisibility(input.value, isChecked);
            });
        });
    </script>
    <script src="utils/calendar-lang.js"></script>
    <script src="utils/calendar-event.js"></script>
    <script src="utils/calendar.js"></script>
</body>
</html>